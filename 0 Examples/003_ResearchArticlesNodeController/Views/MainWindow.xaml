<Window x:Class="Aki32Utilities.UsageExamples.ResearchArticlesNodeController.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:Aki32Utilities.UsageExamples.ResearchArticlesNodeController.ViewModels"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:graph="clr-namespace:Aki32Utilities.WPFAppUtilities.NodeController.Controls;assembly=201_NodeController"
        xmlns:mah="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
        xmlns:converters="clr-namespace:Aki32Utilities.UsageExamples.ResearchArticlesNodeController.Converters"
        xmlns:research="clr-namespace:Aki32Utilities.ConsoleAppUtilities.Research;assembly=111_Research"
        mc:Ignorable="d"
        Title="論文管理" 
        d:Height="1300"
        d:Width="1300"
        >

    <Window.DataContext>
        <vm:MainWindowViewModel/>
    </Window.DataContext>

    <Window.InputBindings>
        <KeyBinding Gesture="Ctrl+S" Command="{Binding SaveCommand}"/>
        <KeyBinding Gesture="Ctrl+R" Command="{Binding RearrangeNodesAlignLeftCommand}"/>
        <KeyBinding Gesture="Ctrl+N" Command="{Binding AddNodeCommand}"/>
        <KeyBinding Gesture="Ctrl+Shift+R" Command="{Binding RearrangeNodesChronologicallyAlignLeftCommand}"/>
        <KeyBinding Gesture="Ctrl+F" Command="{Binding OpenSearchTabCommand}"/>
        <KeyBinding Gesture="Delete" Command="{Binding RemoveSelectingArticleNodesCommand}"/>
        <KeyBinding Gesture="Ctrl+Shift+M" Command="{Binding MergeIfMergeableForAllCommand}"/>
    </Window.InputBindings>

    <Window.Resources>

        <converters:BooleanToForegroundBrushConverter x:Key="BooleanToForegroundBrushConverter"/>

        <sys:Double x:Key="NodeContentFontSize">24.0</sys:Double>

        <Brush x:Key="IsFavoriteColor">#E95B6B</Brush>
        <Brush x:Key="IsReadColor">YellowGreen</Brush>
        <Brush x:Key="WillReadColor">LightGreen</Brush>
        <Brush x:Key="IsGroupingColor">Yellow</Brush>
        <Brush x:Key="IsWebColor">LightBlue</Brush>
        <Brush x:Key="IsLocalSearchMatchedColor">Aqua</Brush>
        <Brush x:Key="IsTempColor">DarkOrange</Brush>
        <Brush x:Key="IsCat1Color">white</Brush>
        <Brush x:Key="IsCat2Color">HotPink</Brush>
        <Brush x:Key="IsCat3Color">Purple</Brush>
        <Brush x:Key="IsBusyHeaderColor">WhiteSmoke</Brush>

        <Brush x:Key="temp1">Pink</Brush>
        <Brush x:Key="temp2">DeepPink</Brush>
        <Brush x:Key="temp3">MediumPurple</Brush>
        <Brush x:Key="temp4">Purple</Brush>
        <Brush x:Key="temp5">Gray</Brush>

        <Style x:Key="ToggleButtonTextStyle" TargetType="ToggleButton">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border CornerRadius="11" Padding="6,3,6,3" Background="{TemplateBinding Background}">
                            <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsChecked" Value="True">
                    <Setter Property="Background" Value="LightBlue" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ButtonTextStyle" TargetType="Button">
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="11" Padding="6,3,6,3" Background="{TemplateBinding Background}">
                            <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ButtonTextStretchStyle" TargetType="Button" BasedOn="{StaticResource ButtonTextStyle}">
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
        </Style>

        <Style x:Key="ProgressRingStyle" TargetType="mah:ProgressRing">
            <Setter Property="Height" Value="13"/>
            <Setter Property="Width" Value="13"/>
            <Setter Property="MinWidth" Value="13"/>
            <Setter Property="MinHeight" Value="13"/>
        </Style>

        <Style x:Key="UserTextBoxStyle" TargetType="TextBox">
            <Setter Property="Foreground" Value="WhiteSmoke"/>
            <Setter Property="Background" Value="#FF080808"/>
            <Setter Property="AcceptsReturn" Value="True"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <ContextMenu x:Key="NodeGraphContextMenu">
            <MenuItem Header="★ 文献管理" IsHitTestVisible="False"/>
            <MenuItem Header="　 新規文献を追加 *" InputGestureText="Ctrl+N" Command="{Binding AddNodeCommand}"/>
            <MenuItem Header="　 選択中の文献を全て削除 *" InputGestureText="Delete"  Command="{Binding RemoveSelectingArticleNodesCommand}"/>
            <MenuItem Header="　 一時的な文献データを全て削除 *" InputGestureText=""  Command="{Binding RemoveTempArticleNodesCommand}"/>
            <MenuItem Header="　 選択中の文献をから一時データラベルを外す" InputGestureText=""  Command="{Binding AcceptSelectingArticleNodesCommand}"/>
            <MenuItem Header="　 マージ可能な文献を全てマージ" InputGestureText="Ctrl+Shift+M"  Command="{Binding MergeIfMergeableForAllCommand}"/>
            <MenuItem Header="　 選択中の2つの文献をマージ" InputGestureText=""  Command="{Binding MergeSelectingTwoArticleNodesCommand}"/>
            <MenuItem Header="　 選択中の1つの文献を複製" InputGestureText=""  Command="{Binding DuplicateSelectingArticleNodeCommand}"/>
            <MenuItem Header="★ 整列" IsHitTestVisible="False"/>
            <MenuItem Header="　 文献を整列 (単純)" InputGestureText="Ctrl+R" Command="{Binding RearrangeNodesAlignLeftCommand}"/>
            <MenuItem Header="　 文献を整列 (年代順)" InputGestureText="Ctrl+Shift+R" Command="{Binding RearrangeNodesChronologicallyAlignLeftCommand}"/>
            <MenuItem Header="★ ーーーーー" IsHitTestVisible="False"/>
            <MenuItem Header="　 " IsHitTestVisible="False"/>
            <MenuItem Header="　 * = よく使うコマンド" IsHitTestVisible="False" HorizontalAlignment="Right" HorizontalContentAlignment="Right"/>
        </ContextMenu>

        <Style x:Key="NodeInputStyle" TargetType="{x:Type graph:NodeInputContent}" BasedOn="{StaticResource {x:Type graph:NodeInputContent}}">
            <Setter Property="Guid" Value="{Binding Guid, Mode=OneWay}"/>
            <Setter Property="Content" Value="{Binding Label}"/>
            <Setter Property="ToolTip" Value="{Binding ToolTip}"/>
            <Setter Property="IsEnabled" Value="{Binding IsEnable}"/>
            <Setter Property="AllowToConnectMultiple" Value="{Binding AllowToConnectMultiple}"/>
        </Style>

        <Style x:Key="NodeOutputStyle" TargetType="{x:Type graph:NodeOutputContent}" BasedOn="{StaticResource {x:Type graph:NodeOutputContent}}">
            <Setter Property="Guid" Value="{Binding Guid, Mode=OneWay}"/>
            <Setter Property="Content" Value="{Binding Label}"/>
            <Setter Property="ToolTip" Value="{Binding ToolTip}"/>
            <Setter Property="IsEnabled" Value="{Binding IsEnable}"/>
        </Style>

        <Style x:Key="NodeLinkStyle" TargetType="{x:Type graph:NodeLink}" BasedOn="{StaticResource {x:Type graph:NodeLink}}">
            <Setter Property="Guid" Value="{Binding Guid, Mode=OneWay}"/>
            <Setter Property="OutputConnectorGuid" Value="{Binding OutputConnectorGuid, Mode=OneWay}"/>
            <Setter Property="InputConnectorGuid" Value="{Binding InputConnectorGuid, Mode=OneWay}"/>
            <Setter Property="IsLocked" Value="{Binding IsLocked, Mode=OneWay}"/>
            <Setter Property="IsSelected" Value="{Binding IsSelected}"/>
            <!--dont need to specify Mode=TwoWay because link is set default two way property.-->
        </Style>

        <Style x:Key="DefaultNodeStyle" TargetType="{x:Type graph:DefaultNode}" BasedOn="{StaticResource {x:Type graph:DefaultNode}}">
            <Setter Property="Guid" Value="{Binding Guid, Mode=OneWay}"/>
            <!--disconnect position binding if you specify Mode=OneWay, because it will change binding position instance in view control.-->
            <Setter Property="Position" Value="{Binding Position}"/>
            <Setter Property="IsSelected" Value="{Binding IsSelected}"/>
            <Setter Property="Inputs" Value="{Binding Inputs}"/>
            <Setter Property="InputLayout" Value="Center"/>
            <Setter Property="Outputs" Value="{Binding Outputs}"/>
            <Setter Property="OutputLayout" Value="Center"/>
            <Setter Property="InputMargin" Value="10"/>
            <Setter Property="OutputMargin" Value="10"/>
            <Setter Property="InputStyle" Value="{StaticResource NodeInputStyle}"/>
            <Setter Property="OutputStyle" Value="{StaticResource NodeOutputStyle}"/>
            <Setter Property="SizeChangedCommand" Value="{Binding SizeChangedCommand}"/>
            <Setter Property="HeaderContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Border 
                            Background="{Binding ArticleHeaderColor}"
                            Margin="-0.1"
                            CornerRadius="11,11,0,0"
                            ClipToBounds="True"
                            >
                            <Border.OpacityMask>
                                <VisualBrush>
                                    <VisualBrush.Visual>
                                        <Border 
                                            Background="Black"
                                            SnapsToDevicePixels="True"
                                            CornerRadius="{Binding CornerRadius, RelativeSource={RelativeSource AncestorType=Border}}"
                                            Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=Border}}"
                                            Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Border}}"
                                            />
                                    </VisualBrush.Visual>
                                </VisualBrush>
                            </Border.OpacityMask>
                            <StackPanel>
                                <Grid>
                                    <ProgressBar 
                                        IsIndeterminate="True" 
                                        Foreground="{StaticResource IsBusyHeaderColor}"
                                        Visibility="{Binding IsNodeBusy, Converter={StaticResource BooleanToVisibilityConverter}}"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Padding="0"
                                        />
                                    <StackPanel 
                                        HorizontalAlignment="Left"
                                        Orientation="Horizontal"
                                        Margin="5,0,2,0"
                                        >
                                        <!--<Label Content="■"/>-->
                                        <Label Content="{Binding NodeHeaderIcon}" Padding="0" VerticalAlignment="Center" Foreground="#FF080808"/>
                                        <Label Content="{Binding NodeHeaderString}" Padding="2,0,0,0" VerticalAlignment="Center" FontWeight="Bold" Foreground="#FF080808"/>
                                    </StackPanel>
                                   
                                    <StackPanel
                                        HorizontalAlignment="Right"
                                        Orientation="Horizontal"
                                        Margin="5,0,2,0"
                                        >
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="Transparent" Visibility="Visible"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource IsFavoriteColor}" Visibility="{Binding IsFavorite, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource IsReadColor}" Visibility="{Binding IsRead, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource WillReadColor}" Visibility="{Binding WillRead, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource IsTempColor}" Visibility="{Binding IsTemp, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource IsGroupingColor}" Visibility="{Binding IsGrouping, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource IsWebColor}" Visibility="{Binding IsWeb, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource IsLocalSearchMatchedColor}" Visibility="{Binding IsLocalSearchMatched, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource IsCat1Color}" Visibility="{Binding IsCategory1, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource IsCat2Color}" Visibility="{Binding IsCategory2, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <Label Margin="0,0,3,0" Padding="0" Content="●" FontSize="20" Foreground="{StaticResource IsCat3Color}" Visibility="{Binding IsCategory3, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                    </DataTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>

                        <!-- グリッド内に表示する情報 -->
                        <Grid
                            Width="300"
                            Margin="3"
                            >

                            <StackPanel
                                Orientation="Vertical"
                                TextBlock.Foreground="White"
                                Visibility="{Binding IsGroupingOrWeb, Converter={StaticResource InverseBooleanToVisibility}}"
                                >

                                <Grid Margin="3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="6"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock 
                                        Grid.Column="0"
                                        Text="著者:" 
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Center"
                                        />
                                    <TextBlock 
                                        Grid.Column="2"
                                        Text="{Binding TopAuthor,Mode=OneWay}"
                                        FontSize="{StaticResource NodeContentFontSize}"
                                        VerticalAlignment="Center"
                                        />

                                </Grid>

                                <Grid Margin="3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="6"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock 
                                        Grid.Column="0"
                                        Text="公開:" 
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Center"
                                        />
                                    <TextBlock 
                                        Grid.Column="2"
                                        Text="{Binding PublishedOn}"
                                        FontSize="{StaticResource NodeContentFontSize}"
                                        VerticalAlignment="Center"
                                        />

                                </Grid>

                                <Grid Margin="3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="6"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock 
                                        Grid.Column="0" 
                                        Text="タイトル:" 
                                        HorizontalAlignment="Right"
                                        />
                                    <TextBlock
                                        Grid.Column="2" 
                                        Text="{Binding ArticleTitle}"
                                        TextWrapping="Wrap"
                                        />

                                </Grid>

                                <Grid Margin="4"/>

                            </StackPanel>

                            <StackPanel
                                Orientation="Vertical"
                                TextBlock.Foreground="White"
                                Visibility="{Binding IsGroupingOrWeb, Converter={StaticResource BooleanToVisibilityConverter}}"
                                >

                                <TextBlock
                                    Margin="10"
                                    Text="{Binding ArticleTitle}"
                                    TextWrapping="Wrap"
                                    FontSize="{StaticResource NodeContentFontSize}"
                                    VerticalAlignment="Center"
                                    TextAlignment="Center"
                                    />

                                <Grid Margin="4"/>

                            </StackPanel>
                            
                        </Grid>

                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="GroupNodeStyle" TargetType="{x:Type graph:GroupNode}" BasedOn="{StaticResource {x:Type graph:GroupNode}}">
            <Setter Property="Guid" Value="{Binding Guid, Mode=OneWay}"/>
            <!--disconnect position binding if you specify Mode=OneWay, because it will change binding position instance in view control.-->
            <Setter Property="Position" Value="{Binding Position}"/>
            <Setter Property="InnerPosition" Value="{Binding InnerPosition}"/>
            <Setter Property="InterlockPosition" Value="{Binding InterlockPosition}"/>
            <Setter Property="InnerWidth" Value="{Binding InnerWidth}"/>
            <Setter Property="InnerHeight" Value="{Binding InnerHeight}"/>
            <Setter Property="Comment" Value="{Binding Comment}"/>
            <Setter Property="CommentSize" Value="24"/>
            <Setter Property="IsSelected" Value="{Binding IsSelected}"/>
            <Setter Property="SizeChangedCommand" Value="{Binding SizeChangedCommand}"/>
            <Setter Property="HeaderContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Border CornerRadius="11,11,0,0" Background="#FF666666">
                            <StackPanel>
                                <StackPanel HorizontalAlignment="Center">
                                    <Label Content="{Binding Name}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="7"/>
            <ColumnDefinition Width="600"/>
        </Grid.ColumnDefinitions>

        <!-- ヘッダー -->
        <Grid 
            Grid.Row="0"
            Grid.Column="0"
            >

            <Menu
                HorizontalAlignment="Stretch"
                VerticalAlignment="Center" 
                VerticalContentAlignment="Center"
                Height="35"
                Margin="0"
                Padding="3,0,0,0"
                >

                <Menu.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel/>
                    </ItemsPanelTemplate>
                </Menu.ItemsPanel>


                <!-- ============================================================================ -->
                <MenuItem IsHitTestVisible="False">
                    <MenuItem.Header>
                        <TextBlock VerticalAlignment="Center" Text="|" Margin="0,0,0,5" FontSize="25" FontWeight="Thin" Foreground="Gray"/>
                    </MenuItem.Header>
                </MenuItem>

                <MenuItem Height="35" Command="{Binding SaveCommand}">
                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Grid>
                                <mah:ProgressRing Visibility="{Binding IsSaveBusy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                <Grid Visibility="{Binding IsSaveBusy, Converter={StaticResource InverseBooleanToVisibility}}">
                                    <TextBlock Text="💾" Visibility="{Binding IsSaveDone, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                    <TextBlock Text="✔️" Visibility="{Binding IsSaveDone, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                </Grid>
                            </Grid>
                            <TextBlock Text=" 保存 "/>
                        </StackPanel>
                    </MenuItem.Header>
                </MenuItem>

                <MenuItem Height="35" Header="テスト" Command="{Binding TestCommand}"/>


                <!-- ============================================================================ -->
                <MenuItem IsHitTestVisible="False">
                    <MenuItem.Header>
                        <TextBlock VerticalAlignment="Center" Text="|" Margin="0,0,0,5" FontSize="25" FontWeight="Thin" Foreground="Gray"/>
                    </MenuItem.Header>
                </MenuItem>

                <MenuItem Height="35">
                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">

                            <TextBlock
                                VerticalAlignment="Center" 
                                Text="強調表示：" 
                                />

                            <ComboBox
                                Margin="0,4,4,4"
                                Height="24" 
                                ItemsSource="{Binding EmphasizePropertyItems, Mode=OneTime}" 
                                SelectedItem="{Binding SelectedEmphasizePropertyItem}" 
                                ToolTip="強調表示対象"
                                />

                        </StackPanel>
                    </MenuItem.Header>
                </MenuItem>


                <!-- ============================================================================ -->
                <MenuItem IsHitTestVisible="False">
                    <MenuItem.Header>
                        <TextBlock VerticalAlignment="Center" Text="|" Margin="0,0,0,5" FontSize="25" FontWeight="Thin" Foreground="Gray"/>
                    </MenuItem.Header>
                </MenuItem>


                <!-- ============================================================================ -->

            </Menu>

        </Grid>

        <!-- ノードグラフ -->
        <Grid
            Grid.Row="1" 
            Grid.Column="0"
            >

            <graph:NodeGraph
                Grid.Row="1"
                x:Name="NodeGraph"
                MoveWithMouse="Right"
                Scale="{Binding Scale}"
                Offset="{Binding CanvasOffset}"
                ExecuteDynamicNodeRepulsions="{Binding ExecuteDynamicNodeRepulsions}"
                ExecuteDynamicLinkAttractions="{Binding ExecuteDynamicLinkAttractions}"
                ItemsSource="{Binding NodeViewModels}"
                ItemContainerStyle="{StaticResource DefaultNodeStyle}"
                NodeLinks="{Binding NodeLinkViewModels}"
                NodeLinkStyle="{StaticResource NodeLinkStyle}"
                GroupNodes="{Binding GroupNodeViewModels}"
                GroupNodeStyle="{StaticResource GroupNodeStyle}"
                PreviewConnectLinkCommand="{Binding PreviewConnectLinkCommand}"
                ConnectedLinkCommand="{Binding ConnectedLinkCommand}"
                DisconnectedLinkCommand="{Binding DisconnectedLinkCommand}"
                AllowToOverrideConnection="False"
                ClipToBounds="True"
                ContextMenu="{StaticResource NodeGraphContextMenu}"
                >

                <graph:NodeGraph.Style>
                    <Style TargetType="{x:Type graph:NodeGraph}" BasedOn="{StaticResource {x:Type graph:NodeGraph}}">
                        <Style.Triggers>
                            <!--Group intersect -->
                            <DataTrigger Binding="{Binding SelectedGroupIntersectType}" Value="{x:Static vm:GroupIntersectType.CursorPointVMDefine}">
                                <Setter Property="GroupIntersectType" Value="{x:Static graph:GroupIntersectType.CursorPoint}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding SelectedGroupIntersectType}" Value="{x:Static vm:GroupIntersectType.BoundingBoxVMDefine}">
                                <Setter Property="GroupIntersectType" Value="{x:Static graph:GroupIntersectType.BoundingBox}"/>
                            </DataTrigger>

                            <!--Range selection mode-->
                            <DataTrigger Binding="{Binding SelectedRangeSelectionMode}" Value="{x:Static vm:RangeSelectionMode.包含}">
                                <Setter Property="RangeSelectionMode" Value="{x:Static graph:RangeSelectionMode.Contain}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding SelectedRangeSelectionMode}" Value="{x:Static vm:RangeSelectionMode.接触}">
                                <Setter Property="RangeSelectionMode" Value="{x:Static graph:RangeSelectionMode.Intersect}"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </graph:NodeGraph.Style>

                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectionChanged">
                        <i:InvokeCommandAction Command="{Binding SelectionChangedCommand}" CommandParameter="{Binding SelectedItems, ElementName=NodeGraph}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </graph:NodeGraph>

        </Grid>

        <!-- 右パネル -->
        <Grid 
            Grid.Row="0"
            Grid.RowSpan="2"
            Grid.Column="2"
            >

            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="5"/>
                <RowDefinition Height="200"/>
            </Grid.RowDefinitions>

            <GridSplitter 
                Grid.Column="0"
                Grid.Row="1"
                HorizontalAlignment="Stretch" 
                />

            <TabControl 
                x:Name="TabControl_RightPanel"
                Grid.Row="0"
                mah:HeaderedControlHelper.HeaderFontSize="13"
                >
                <TabItem x:Name="TabItem_SelectingNode">
                    <TabItem.Header>
                        <Grid Height="27">
                            <TextBlock
                                FontSize="13"
                                Text=" 📄 選択中の文献 "
                                VerticalAlignment="Center"
                                />
                        </Grid>
                    </TabItem.Header>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Margin="4" Grid.Row="0">

                            <Grid Margin="4">

                                <TextBlock
                                    Text="情報収集：" 
                                    Width="70"
                                    Margin="0,7,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="コマンド"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>

                                <WrapPanel
                                    Margin="70,0,0,0"
                                    >

                                    <Button
                                        Margin="3"
                                        Style="{StaticResource ButtonTextStretchStyle}"
                                        Command="{Binding PullReferenceInfoCommand}"
                                        Foreground="{Binding SelectedNodeViewModel.RecommendPullReferenceInfo, Converter={StaticResource BooleanToForegroundBrushConverter}}"
                                        ToolTip="オンラインから引用関係をダウンロードして，追記します。&#10;&#10;※ 既に十分なデータが揃っている場合，薄い表示になります。"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid Margin="0,0,3,0">
                                                <mah:ProgressRing Visibility="{Binding IsPullReferenceInfoBusy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsPullReferenceInfoBusy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="⬇️" Visibility="{Binding IsPullReferenceInfoDone, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsPullReferenceInfoDone, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text="引用関係を取得 "/>
                                            <TextBlock Text=""/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Style="{StaticResource ButtonTextStretchStyle}"
                                        Command="{Binding PullNormalMetaInfoCommand}"
                                        Foreground="{Binding SelectedNodeViewModel.RecommendPullNormalMetaInfo, Converter={StaticResource BooleanToForegroundBrushConverter}}"
                                        ToolTip="オンラインからメタ情報をダウンロードして，追記します。&#10;&#10;※ 既に十分なデータが揃っている場合，薄い表示になります。"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid Margin="0,0,3,0">
                                                <mah:ProgressRing Visibility="{Binding IsPullNormalMetaInfoBusy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsPullNormalMetaInfoBusy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="⬇️" Visibility="{Binding IsPullNormalMetaInfoDone, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsPullNormalMetaInfoDone, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text="メタ情報を取得 "/>
                                            <TextBlock Text=""/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Style="{StaticResource ButtonTextStretchStyle}"
                                        Command="{Binding PullAIMetaInfoCommand}"
                                        Foreground="{Binding SelectedNodeViewModel.RecommendPullAIMetaInfo, Converter={StaticResource BooleanToForegroundBrushConverter}}"
                                        ToolTip="文献文字列からメタ情報を推測して，追記します。&#10;（ChatGPTを有効化することで利用可能）&#10;&#10;※ 既に十分なデータが揃っている場合，薄い表示になります。"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid Margin="0,0,3,0">
                                                <mah:ProgressRing Visibility="{Binding IsPullAIMetaInfoBusy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsPullAIMetaInfoBusy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="⚡" Visibility="{Binding IsPullAIMetaInfoDone, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsPullAIMetaInfoDone, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text="メタ情報を推測 "/>
                                            <TextBlock Text=""/>
                                        </StackPanel>
                                    </Button>

                                </WrapPanel>
                            </Grid>

                            <Grid Margin="4">

                                <TextBlock
                                    Text="表示：" 
                                    Width="70"
                                    Margin="0,7,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="コマンド"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>

                                <WrapPanel
                                    Margin="70,0,0,0"
                                    >

                                    <Button
                                        Margin="3"
                                        Style="{StaticResource ButtonTextStretchStyle}"
                                        Command="{Binding OpenPDFCommand}"
                                        Foreground="{Binding SelectedNodeViewModel.RecommendOpenPDF, Converter={StaticResource BooleanToForegroundBrushConverter}}"
                                        ToolTip="PDFを表示します。&#10;もしローカルに存在しない場合は，自動でダウンロードします。&#10;&#10;※ PDFが入手できる状態でない場合，薄い表示になります。"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid Margin="0,0,3,0">
                                                <mah:ProgressRing Visibility="{Binding IsOpenPDFBusy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsOpenPDFBusy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="📄" Visibility="{Binding IsOpenPDFDone, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsOpenPDFDone, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text="PDFを表示 "/>
                                            <TextBlock Text=""/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Style="{StaticResource ButtonTextStretchStyle}"
                                        Command="{Binding OpenWebSiteCommand}"
                                        Foreground="{Binding SelectedNodeViewModel.RecommendOpenWebSite, Converter={StaticResource BooleanToForegroundBrushConverter}}"
                                        ToolTip="紐づけられたWebサイトをブラウザで表示します。&#10;&#10;※Webにアクセスできる状態でない場合，薄い表示になります。"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid Margin="0,0,3,0">
                                                <mah:ProgressRing Visibility="{Binding IsOpenWebSiteBusy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsOpenWebSiteBusy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="🌐" Visibility="{Binding IsOpenWebSiteDone, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsOpenWebSiteDone, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text="Webサイトを表示 "/>
                                            <TextBlock Text=""/>
                                        </StackPanel>
                                    </Button>

                                </WrapPanel>
                            </Grid>

                            <Grid Margin="4">

                                <TextBlock
                                    Text="自動化：" 
                                    Width="70"
                                    Margin="0,7,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="コマンド"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>

                                <WrapPanel
                                    Margin="70,0,0,0"
                                    >

                                    <Button
                                        Margin="3"
                                        Style="{StaticResource ButtonTextStretchStyle}"
                                        Command="{Binding ExecuteAllCommand}"
                                        Foreground="{Binding SelectedNodeViewModel.RecommendExecuteAll, Converter={StaticResource BooleanToForegroundBrushConverter}}"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <Button.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="以下の操作を全て試行します。
                                                &#10; - 引用関係を取得
                                                &#10; - メタ情報を取得
                                                &#10; - メタ情報を推測
                                                &#10; - PDFのダウンロード
                                                &#10; - AIにまとめてもらう
                                                &#10;
                                                &#10;※ 未実装です。
                                                &#10;※ 需要が低いと判断した場合，薄い表示になります。
                                                "
                                                >
                                            </TextBlock>
                                        </Button.ToolTip>
                                        <StackPanel Orientation="Horizontal">
                                            <Grid Margin="0,0,3,0">
                                                <mah:ProgressRing Visibility="{Binding IsExecuteAllBusy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsExecuteAllBusy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="⚡" Visibility="{Binding IsExecuteAllDone, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsExecuteAllDone, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text="一括実行 "/>
                                            <TextBlock Text=""/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Style="{StaticResource ButtonTextStretchStyle}"
                                        Command="{Binding AISummaryCommand}"
                                        Foreground="{Binding SelectedNodeViewModel.RecommendAISummary, Converter={StaticResource BooleanToForegroundBrushConverter}}"
                                        ToolTip="AIに論文を読んでもらって，まとめ文章を作成してもらいます。&#10;（DocsBotを有効化することで利用可能）&#10;&#10;※ 未実装です。&#10;※ 既に十分なデータが揃っている場合，薄い表示になります。"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid Margin="0,0,3,0">
                                                <mah:ProgressRing Visibility="{Binding IsAISummaryBusy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsAISummaryBusy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="⚡" Visibility="{Binding IsAISummaryDone, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsAISummaryDone, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text="AIにまとめてもらう "/>
                                            <TextBlock Text=""/>
                                        </StackPanel>
                                    </Button>

                                </WrapPanel>
                            </Grid>

                            <Grid Margin="4">

                                <TextBlock
                                    Text="その他：" 
                                    Width="70"
                                    Margin="0,7,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="コマンド"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>

                                <WrapPanel
                                    Margin="70,0,0,0"
                                    >

                                    <Button
                                        Margin="3"
                                        Name="Button_ManuallyAddPDF"
                                        Style="{StaticResource ButtonTextStretchStyle}"
                                        Command="{Binding ManuallyAddPDFCommand}"
                                        Foreground="{Binding SelectedNodeViewModel.RecommendManuallyAddPDF, Converter={StaticResource BooleanToForegroundBrushConverter}}"
                                        ToolTip="PDFをデータベースに手動で追加します。&#10;PDFファイルをここにドロップすることもできます。&#10;&#10;※ 既に十分なデータが揃っている場合，薄い表示になります。"
                                        ToolTipService.InitialShowDelay="10" 
                                        AllowDrop="True"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid Margin="0,0,3,0">
                                                <mah:ProgressRing Visibility="{Binding IsManuallyAddPDFBusy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsManuallyAddPDFBusy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="📄" Visibility="{Binding IsManuallyAddPDFDone, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsManuallyAddPDFDone, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text="PDF手動追加 "/>
                                            <TextBlock Text=""/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Style="{StaticResource ButtonTextStretchStyle}"
                                        Command="{Binding UndefinedButton1Command}"
                                        ToolTip="キープ&#10;&#10;※ 未実装です。&#10;※ 既に十分なデータが揃っている場合，薄い表示になります。"
                                        Foreground="{Binding SelectedNodeViewModel.RecommendKeep, Converter={StaticResource BooleanToForegroundBrushConverter}}"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid Margin="0,0,3,0">
                                                <mah:ProgressRing Visibility="{Binding IsUndefinedButton1Busy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsUndefinedButton1Busy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="❓" Visibility="{Binding IsUndefinedButton1Done, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsUndefinedButton1Done, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text="キープ "/>
                                            <TextBlock Text=""/>
                                        </StackPanel>
                                    </Button>

                                </WrapPanel>
                            </Grid>

                            <!-- ========================================== -->
                            <Grid Height="4"/>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="タグ：" 
                                    Width="70"
                                    Margin="0,7,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="タグ&#10;クリックすると入れ替わります。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>

                                <WrapPanel
                                    Margin="70,0,0,0"
                                    >

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.IsFavorite}"
                                        ToolTip=""
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="♥" Foreground="{StaticResource IsFavoriteColor}"/>
                                            <TextBlock Text="お気に入り"/>
                                        </StackPanel>
                                    </ToggleButton>

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.IsRead}"
                                        ToolTip=""
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="●" Foreground="{StaticResource IsReadColor}" Margin="0,0,2,0"/>
                                            <TextBlock Text="既読"/>
                                        </StackPanel>
                                    </ToggleButton>

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.WillRead}"
                                        ToolTip=""
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="●" Foreground="{StaticResource WillReadColor}" Margin="0,0,2,0"/>
                                            <TextBlock Text="積読"/>
                                        </StackPanel>
                                    </ToggleButton>

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.IsTemp}"
                                        ToolTip=""
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="●" Foreground="{StaticResource IsTempColor}" Margin="0,0,2,0"/>
                                            <TextBlock Text="一時ﾃﾞｰﾀ"/>
                                        </StackPanel>
                                    </ToggleButton>

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.IsGrouping}"
                                        ToolTip=""
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="●" Foreground="{StaticResource IsGroupingColor}" Margin="0,0,2,0"/>
                                            <TextBlock Text="ｸﾞﾙｰﾌﾟ"/>
                                        </StackPanel>
                                    </ToggleButton>

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.IsWeb}"
                                        ToolTip=""
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="●" Foreground="{StaticResource IsWebColor}" Margin="0,0,2,0"/>
                                            <TextBlock Text="ｳｪﾌﾞ"/>
                                        </StackPanel>
                                    </ToggleButton>

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.IsLocalSearchMatched, Mode=OneWay}"
                                        IsHitTestVisible="False"
                                        ToolTip=""
                                        IsEnabled="False"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="●" Foreground="{StaticResource IsLocalSearchMatchedColor}" Margin="0,0,2,0"/>
                                            <TextBlock Text="検索に一致"/>
                                        </StackPanel>
                                    </ToggleButton>

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.IsCategory1}"
                                        ToolTip=""
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="📒" Foreground="{StaticResource IsCat1Color}" Margin="0,0,2,0"/>
                                            <TextBlock Text="ﾒﾓ1"/>
                                        </StackPanel>
                                    </ToggleButton>

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.IsCategory2}"
                                        ToolTip=""
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="📒" Foreground="{StaticResource IsCat2Color}" Margin="0,0,2,0"/>
                                            <TextBlock Text="ﾒﾓ2"/>
                                        </StackPanel>
                                    </ToggleButton>

                                    <ToggleButton
                                        Margin="3"
                                        Style="{StaticResource ToggleButtonTextStyle}"
                                        IsChecked="{Binding SelectedNodeViewModel.IsCategory3}"
                                        ToolTip=""
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="📒" Foreground="{StaticResource IsCat3Color}" Margin="0,0,2,0"/>
                                            <TextBlock Text="ﾒﾓ3"/>
                                        </StackPanel>
                                    </ToggleButton>

                                </WrapPanel>

                            </Grid>

                        </StackPanel>


                        <ScrollViewer
                            VerticalScrollBarVisibility="Visible"
                            HorizontalScrollBarVisibility="Disabled"
                            Grid.Row="1"
                            >

                            <StackPanel Margin="4">

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="著者：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="authors"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="70,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.Authors, UpdateSourceTrigger=LostFocus}" 
                                        TextWrapping="Wrap" AcceptsReturn="False"
                                        />
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="タイトル：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="title"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="70,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.ArticleTitle, UpdateSourceTrigger=PropertyChanged}" 
                                        TextWrapping="Wrap" AcceptsReturn="False"
                                        />
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="メモ：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="memo"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="70,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.Article.Memo}" 
                                        TextWrapping="Wrap" AcceptsReturn="True"
                                        />
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="研究の出発点：" 
                                        Width="100" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="【Motivation: 研究の出発点】
    &#10; - どんな課題や問題点を解決しようとしたのか？
    &#10; - 既存の研究で足りないところはどこだったのか？">
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="100,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.Article.Memo_Motivation}" 
                                        TextWrapping="Wrap" AcceptsReturn="True"
                                        />
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="研究手法：" 
                                        Width="100" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="【Method: 研究手法】
    &#10; - どんなシステムを作ったか？なぜそのシステム設計でよいと仮定したか？
    &#10; - どんなアルゴリズムを作ったか？なぜそのアルゴリズム設計でよいと仮定したか？
    &#10; - どんな調査をしたか？なぜその調査計画でよいと仮定したか？
    &#10; - どんな実験をしたか？なぜその実験設計でよいと仮定したか？">
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="100,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.Article.Memo_Method}" 
                                        TextWrapping="Wrap" AcceptsReturn="True"
                                        />
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="結果と知見：" 
                                        Width="100" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="【Insights: 結果と知見】
    &#10; - どんな結果が得られたのか？どんな条件だと上手くいって，どんな場合は上手くいかなかったのか？
    &#10; - 新しくわかった知見はなにか？他のアプリケーションやシステムでも使えそうな知見は何か？">
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="100,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.Article.Memo_Insights}" 
                                        TextWrapping="Wrap" AcceptsReturn="True"
                                        />
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="貢献を一行で：" 
                                        Width="100" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="【Contribution Summary: 貢献を一行で】
    &#10; - 「【Author】は，【Motivation】という課題解決のために【Method】を行い，【Insight】がわかった。」">
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="100,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.Article.Memo_Contribution}" 
                                        TextWrapping="Wrap" AcceptsReturn="True"
                                        />
                                </Grid>

                                <!-- ========================================== -->
                                <Grid Height="25"/>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="公開日：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="公開日。&#10;ハイフン区切りにすることで年月日が認識されます。"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="70,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.PublishedOn, UpdateSourceTrigger=PropertyChanged}" 
                                        TextWrapping="NoWrap" AcceptsReturn="False"
                                        />
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="資料：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="release"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="70,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.MaterialTitle, UpdateSourceTrigger=PropertyChanged}" 
                                        TextWrapping="NoWrap" AcceptsReturn="False"
                                        />
                                </Grid>

                                <Grid Margin="4">

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Column="1"
                                        Text="巻：" 
                                        Margin="10,0,0,0"
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="release"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Grid.Column="2"
                                        Text="{Binding SelectedNodeViewModel.MaterialVolume, UpdateSourceTrigger=PropertyChanged}" 
                                        TextWrapping="NoWrap" AcceptsReturn="False"
                                        />

                                    <TextBlock
                                        Grid.Column="3"
                                        Text="号：" 
                                        Margin="10,0,0,0"
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="release"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Grid.Column="4"
                                        Text="{Binding SelectedNodeViewModel.MaterialSubVolume, UpdateSourceTrigger=PropertyChanged}" 
                                        TextWrapping="NoWrap" AcceptsReturn="False"
                                        />

                                    <TextBlock
                                        Grid.Column="5"
                                        Text="開始ページ：" 
                                        Margin="10,0,0,0"
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="release"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>

                                    <TextBox 
                                        Grid.Column="6"
                                        Text="{Binding SelectedNodeViewModel.StartingPage, UpdateSourceTrigger=PropertyChanged}" 
                                        TextWrapping="NoWrap" AcceptsReturn="False"
                                        />

                                    <TextBlock
                                        Grid.Column="7"
                                        Text="終了ページ：" 
                                        Margin="10,0,0,0"
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="release"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Grid.Column="8"
                                        Text="{Binding SelectedNodeViewModel.EndingPage, UpdateSourceTrigger=PropertyChanged}" 
                                        TextWrapping="NoWrap" AcceptsReturn="False"
                                        />

                                </Grid>

                                <!-- ========================================== -->
                                <Grid Height="25"/>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="DOI：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="DOI"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBox 
                                        Margin="70,0,0,0" 
                                        Text="{Binding SelectedNodeViewModel.Article.DOI, UpdateSourceTrigger=PropertyChanged}" 
                                        TextWrapping="NoWrap" AcceptsReturn="False"
                                        />
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="AOI：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="AOI"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>

                                    <StackPanel
                                        Margin="70,0,0,0" 
                                        Orientation="Horizontal"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <StackPanel.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="AOI ( 簡易AOI )&#10;クリックして簡易AOIをコピー"
                                                >
                                            </TextBlock>
                                        </StackPanel.ToolTip>

                                        <TextBlock Text="{Binding SelectedNodeViewModel.Article.AOI}"/>
                                        <TextBlock Text=" ( "/>
                                        <TextBlock Text="{Binding SelectedNodeViewModel.Article.Friendly_AOI}"/>
                                        <TextBlock Text=" )"/>
                                    </StackPanel>

                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="データ元：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="「データ取得元」を列挙します。"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBlock 
                                        Text="{Binding SelectedNodeViewModel.DataFrom}" 
                                        Margin="70,0,0,0" 
                                        TextWrapping="Wrap"
                                        />
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="文献：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="文献文字列&#10;クリックしてコピー"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBlock 
                                        Text="{Binding SelectedNodeViewModel.Article.ReferenceString}" 
                                        Margin="70,0,0,0" 
                                        TextWrapping="Wrap"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="文献文字列&#10;クリックしてコピー"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                </Grid>

                                <!-- ========================================== -->
                                <Grid Height="25"/>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="XRef文献：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="CrossRef_UnstructuredRefString"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBlock 
                                        Text="{Binding SelectedNodeViewModel.Article.CrossRef_UnstructuredRefString}" 
                                        Margin="70,0,0,0" 
                                        TextWrapping="Wrap"
                                        >
                                    </TextBlock>
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="JStage文献：" 
                                        Width="70" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="JStage_UnstructuredRefString"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBlock 
                                        Text="{Binding SelectedNodeViewModel.Article.JStage_UnstructuredRefString}" 
                                        Margin="70,0,0,0" 
                                        TextWrapping="Wrap"
                                        >
                                    </TextBlock>
                                </Grid>

                                <Grid Margin="4">
                                    <TextBlock
                                        Text="作成日：" 
                                        Width="70"
                                        HorizontalAlignment="Left"
                                        TextAlignment="Right"
                                        ToolTipService.InitialShowDelay="10" 
                                        >
                                        <TextBlock.ToolTip>
                                            <TextBlock
                                                TextAlignment="Left"
                                                Text="JStage_UnstructuredRefString"
                                                >
                                            </TextBlock>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <TextBlock 
                                        Text="{Binding SelectedNodeViewModel.Article.Private_CreatedDate}" 
                                        Margin="70,0,0,0" 
                                        TextWrapping="Wrap"
                                        >
                                    </TextBlock>
                                </Grid>







                            </StackPanel>

                        </ScrollViewer>

                        <Button
                            Style="{StaticResource ButtonTextStyle}"
                            Command="{Binding RefreshSelectedArticleInfoCommand}"
                            Content="↺"
                            FontSize="15"
                            Background="#01FFFFFF"
                            Grid.Row="1"
                            Margin="0,0,25,10"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Bottom"
                            />

                    </Grid>
                </TabItem>
                <TabItem Header=" 🔎 検索 " x:Name="TabItem_Search">
                    <ScrollViewer
                        HorizontalScrollBarVisibility="Disabled">
                        <StackPanel Margin="4">

                            <Grid Height="10"/>
                            <Grid Margin="4">
                                <TextBlock
                                    Text="ローカル検索"
                                    FontSize="20"
                                    HorizontalAlignment="Left"
                                    >
                                </TextBlock>
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="検索文字列：" 
                                    Width="70" 
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="検索対象：著者名，タイトル，AOI"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    x:Name="TextBox_LocalSearch"
                                    Margin="70,0,0,0" 
                                    Text="{Binding LocalSearchString, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="Wrap" AcceptsReturn="False"
                                    />
                            </Grid>

                            <Grid Margin="4">
                                <StackPanel 
                                    Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    >
                                    <Button
                                        Margin="3"
                                        Command="{Binding ResetLocalSearchStringCommand}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        Content="リセット"
                                        />

                                </StackPanel>
                            </Grid>

                            <Grid Height="40"/>
                            <Grid Margin="4">
                                <TextBlock
                                    Text="オンライン検索"
                                    FontSize="20"
                                    HorizontalAlignment="Left"
                                    >
                                </TextBlock>
                                <TextBlock
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    ToolTipService.InitialShowDelay="20"
                                    ToolTip="新しい情報提供元を新たに追加するように依頼していただくことが可能です。
                                    &#10;
                                    &#10;※ 手間賃として，前払いで手数料を請求させていただきます。
                                    &#10;※ サイトによってはAPIが提供されていない等の理由で対応できない場合があります。予めご了承ください。"
                                    >
                                    <Span>
                                        <Hyperlink NavigateUri="aki32.work@gmail.com">※ 情報提供元の追加依頼</Hyperlink>
                                    </Span>
                                </TextBlock>
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="パターンA"
                                    Margin="4,0,0,0"
                                    FontSize="17"
                                    HorizontalAlignment="Left"
                                    >
                                </TextBlock>
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="フリーワード：" 
                                    Width="70" 
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="フリーワード。&#10;長すぎるとエラーになる場合が多いです。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Margin="70,0,0,0" 
                                    Text="{Binding InternetSearch_FreeWord, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="Wrap" AcceptsReturn="False"
                                    />
                            </Grid>

                            <Grid Margin="4">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Column="3"
                                    Text="何年から：" 
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="公開年が何年以降のものを検索するか指定できます。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Grid.Column="4"
                                    Text="{Binding InternetSearch_PublishedFrom, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="NoWrap" AcceptsReturn="False"
                                    />

                                <TextBlock
                                    Grid.Column="5"
                                    Text="何年まで：" 
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="公開年が何年以前のものを検索するか指定できます。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>

                                <TextBox 
                                    Grid.Column="6"
                                    Text="{Binding InternetSearch_PublishedUntil, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="NoWrap" AcceptsReturn="False"
                                    />

                                <TextBlock
                                    Grid.Column="7"
                                    Text="最大データ数：" 
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="検索のデータの最大数を指定します。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Grid.Column="8"
                                    Text="{Binding InternetSearch_DataMaxCount, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="NoWrap" AcceptsReturn="False"
                                    />

                            </Grid>

                            <Grid Margin="4">
                                <StackPanel 
                                    Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    >
                                    <Button
                                        Margin="3"
                                        Command="{Binding InternetSearch_CiNii_A_Command}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <mah:ProgressRing Visibility="{Binding IsInternetSearch_CiNii_A_Busy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsInternetSearch_CiNii_A_Busy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="🔎" Visibility="{Binding IsInternetSearch_CiNii_A_Done, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsInternetSearch_CiNii_A_Done, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text=" CiNii "/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Command="{Binding InternetSearch_NDLSearch_A_Command}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <mah:ProgressRing Visibility="{Binding IsInternetSearch_NDLSearch_A_Busy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsInternetSearch_NDLSearch_A_Busy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="🔎" Visibility="{Binding IsInternetSearch_NDLSearch_A_Done, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsInternetSearch_NDLSearch_A_Done, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text=" NDL Search "/>
                                        </StackPanel>
                                    </Button>

                                </StackPanel>
                            </Grid>

                            <Grid Height="20"/>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="パターンB"
                                    Margin="4,0,0,0"
                                    FontSize="17"
                                    HorizontalAlignment="Left"
                                    >
                                </TextBlock>
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="著者：" 
                                    Width="70" 
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="著者"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Margin="70,0,0,0" 
                                    Text="{Binding InternetSearch_Authors, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="Wrap" AcceptsReturn="False"
                                    />
                            </Grid>
                            <Grid Margin="4">
                                <TextBlock
                                    Text="タイトル：" 
                                    Width="70" 
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="タイトル"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Margin="70,0,0,0" 
                                    Text="{Binding InternetSearch_ArticleTitle, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="Wrap" AcceptsReturn="False"
                                    />
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="資料：" 
                                    Width="70" 
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="ジャーナル名"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Margin="70,0,0,0" 
                                    Text="{Binding InternetSearch_MaterialTitle, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="NoWrap" AcceptsReturn="False"
                                    />
                            </Grid>

                            <Grid Margin="4">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Column="1"
                                    Text="巻：" 
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="ジャーナル巻数"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Grid.Column="2"
                                    Text="{Binding InternetSearch_MaterialVolume, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="NoWrap" AcceptsReturn="False"
                                    />

                                <TextBlock
                                    Grid.Column="3"
                                    Text="何年から：" 
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="公開年が何年以降のものを検索するか指定できます。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Grid.Column="4"
                                    Text="{Binding InternetSearch_PublishedFrom, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="NoWrap" AcceptsReturn="False"
                                    />

                                <TextBlock
                                    Grid.Column="5"
                                    Text="何年まで：" 
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="公開年が何年以前のものを検索するか指定できます。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>

                                <TextBox 
                                    Grid.Column="6"
                                    Text="{Binding InternetSearch_PublishedUntil, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="NoWrap" AcceptsReturn="False"
                                    />

                                <TextBlock
                                    Grid.Column="7"
                                    Text="最大データ数：" 
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="検索のデータの最大数を指定します。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Grid.Column="8"
                                    Text="{Binding InternetSearch_DataMaxCount, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="NoWrap" AcceptsReturn="False"
                                    />

                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="キーワード：" 
                                    Width="70" 
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="キーワード"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Margin="70,0,0,0" 
                                    Text="{Binding InternetSearch_Keywords, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="Wrap" AcceptsReturn="True"
                                    />
                            </Grid>

                            <Grid Margin="4">
                                <StackPanel 
                                    Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    >
                                    <Button
                                        Margin="3"
                                        Command="{Binding InternetSearch_JStage_B_Command}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <mah:ProgressRing Visibility="{Binding IsInternetSearch_JStage_B_Busy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsInternetSearch_JStage_B_Busy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="🔎" Visibility="{Binding IsInternetSearch_JStage_B_Done, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsInternetSearch_JStage_B_Done, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text=" J-Stage "/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Command="{Binding InternetSearch_CiNii_B_Command}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <mah:ProgressRing Visibility="{Binding IsInternetSearch_CiNii_B_Busy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsInternetSearch_CiNii_B_Busy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="🔎" Visibility="{Binding IsInternetSearch_CiNii_B_Done, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsInternetSearch_CiNii_B_Done, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text=" CiNii "/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Command="{Binding InternetSearch_NDLSearch_B_Command}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <mah:ProgressRing Visibility="{Binding IsInternetSearch_NDLSearch_B_Busy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsInternetSearch_NDLSearch_B_Busy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="🔎" Visibility="{Binding IsInternetSearch_NDLSearch_B_Done, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsInternetSearch_NDLSearch_B_Done, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text=" NDL Search "/>
                                        </StackPanel>
                                    </Button>


                                </StackPanel>
                            </Grid>

                            <Grid Height="20"/>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="パターンC"
                                    Margin="4,0,0,0"
                                    FontSize="17"
                                    HorizontalAlignment="Left"
                                    >
                                </TextBlock>
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="DOI：" 
                                    Width="70" 
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="DOI"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Margin="70,0,0,0" 
                                    Text="{Binding InternetSearch_DOI, UpdateSourceTrigger=PropertyChanged}" 
                                    TextWrapping="NoWrap" AcceptsReturn="False"
                                    />
                            </Grid>

                            <Grid Margin="4">
                                <StackPanel 
                                    Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    >

                                    <Button
                                        Margin="3"
                                        Command="{Binding InternetSearch_JStage_C_Command}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <mah:ProgressRing Visibility="{Binding IsInternetSearch_JStage_C_Busy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsInternetSearch_JStage_C_Busy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="🔎" Visibility="{Binding IsInternetSearch_JStage_C_Done, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsInternetSearch_JStage_C_Done, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text=" J-Stage "/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Command="{Binding InternetSearch_CiNii_C_Command}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <mah:ProgressRing Visibility="{Binding IsInternetSearch_CiNii_C_Busy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsInternetSearch_CiNii_C_Busy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="🔎" Visibility="{Binding IsInternetSearch_CiNii_C_Done, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsInternetSearch_CiNii_C_Done, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text=" CiNii "/>
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        Margin="3"
                                        Command="{Binding InternetSearch_CrossRef_C_Command}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <mah:ProgressRing Visibility="{Binding IsInternetSearch_CrossRef_C_Busy, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{StaticResource ProgressRingStyle}" Margin="0,0,3.5,0"/>
                                                <Grid Visibility="{Binding IsInternetSearch_CrossRef_C_Busy, Converter={StaticResource InverseBooleanToVisibility}}">
                                                    <TextBlock Text="🔎" Visibility="{Binding IsInternetSearch_CrossRef_C_Done, Converter={StaticResource InverseBooleanToVisibility}}"/>
                                                    <TextBlock Text="✔️" Visibility="{Binding IsInternetSearch_CrossRef_C_Done, Converter={StaticResource BooleanToVisibilityConverter}}" Foreground="Green"/>
                                                </Grid>
                                            </Grid>
                                            <TextBlock Text=" CrossRef "/>
                                        </StackPanel>
                                    </Button>


                                </StackPanel>
                            </Grid>

                            <Grid Height="20"/>





                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <TabItem Header=" 🔧 設定" x:Name="TabItem_Setting">
                    <ScrollViewer
                        HorizontalScrollBarVisibility="Disabled">
                        <StackPanel Margin="4">

                            <!--=========================================================================-->
                            <Grid Height="10"/>
                            <Grid Margin="4">
                                <TextBlock
                                    Text="文献"
                                    FontSize="20"
                                    HorizontalAlignment="Left"
                                    >
                                </TextBlock>
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="文献文字列：" 
                                    Width="100" 
                                    HorizontalAlignment="Left"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="文献文字列生成フォーマット"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <TextBox 
                                    Margin="100,0,0,0" 
                                    Text="{Binding Path=(research:ResearchArticle.ReferenceStringFormat)}"
                                    TextWrapping="Wrap" AcceptsReturn="False"
                                    />
                            </Grid>
                            <Grid Margin="4">
                                <StackPanel
                                        Orientation="Horizontal"
                                        Margin="100,0,0,0"
                                        >

                                    <Button
                                        Margin="0,4,4,4"
                                        Command="{Binding InsertToFormatCommand}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        Content="テスト"
                                        />
                                    <Button
                                        Margin="0,4,4,4"
                                        Command="{Binding InsertToFormatCommand}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        Content="テスト"
                                        />
                                    <Button
                                        Margin="0,4,4,4"
                                        Command="{Binding InsertToFormatCommand, ConverterParameter=ss}"
                                        Style="{StaticResource ButtonTextStyle}"
                                        Content="テスト"
                                        />

                                </StackPanel>
                            </Grid>

                            <!--=========================================================================-->
                            <Grid Height="10"/>
                            <Grid Margin="4">
                                <TextBlock
                                    Text="ノードグラフ操作"
                                    FontSize="20"
                                    HorizontalAlignment="Left"
                                    >
                                </TextBlock>
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="ノード接続保護：" 
                                    Width="100" 
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="ノード接続を削除できない状態にします。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                                <CheckBox
                                    Margin="100,0,0,0" 
                                    Content=""
                                    IsChecked="{Binding IsLockedAllNodeLinks}" 
                                    VerticalContentAlignment="Center" 
                                    ToolTip="ノード接続を削除できない状態にします。"
                                    />
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="物理演算：" 
                                    Width="100"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="ノード接続を削除できない状態にします。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>

                                <StackPanel
                                    Orientation="Horizontal"
                                    Margin="100,0,0,0"
                                    >
                                    <CheckBox
                                        Margin="0,0,10,0"
                                        Content="ノードの重なりによる斥力"
                                        IsChecked="{Binding ExecuteDynamicNodeRepulsions}" 
                                        VerticalContentAlignment="Center"
                                        ToolTip="ノードの距離を，物理演算によって自動で調整します。"
                                        />
                                    <CheckBox
                                        Margin="0,0,10,0"
                                        Content="リンクによる引力"
                                        IsChecked="{Binding ExecuteDynamicLinkAttractions}" 
                                        VerticalContentAlignment="Center"
                                        ToolTip="ノードの距離を，物理演算によって自動で調整します。"
                                        />

                                </StackPanel>
                            </Grid>

                            <Grid Margin="4">
                                <TextBlock
                                    Text="選択：" 
                                    Width="100"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    TextAlignment="Right"
                                    ToolTipService.InitialShowDelay="10" 
                                    >
                                    <TextBlock.ToolTip>
                                        <TextBlock
                                            TextAlignment="Left"
                                            Text="ノード接続を削除できない状態にします。"
                                            >
                                        </TextBlock>
                                    </TextBlock.ToolTip>
                                </TextBlock>

                                <ComboBox
                                    Margin="100,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    ItemsSource="{Binding RangeSelectionModes, Mode=OneTime}" 
                                    SelectedItem="{Binding SelectedRangeSelectionMode}" 
                                    ToolTip="範囲選択モード"
                                    />
                            </Grid>







                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

            </TabControl>

            <Grid Margin="4" Grid.Row="2">
                <TextBlock
                    Text="メッセージ：" 
                    Width="70" 
                    HorizontalAlignment="Left"
                    TextAlignment="Right"
                    ToolTipService.InitialShowDelay="10" 
                    />
                <ListView
                    Margin="70,0,0,0"
                    x:Name="ListView_Console"
                    VerticalAlignment="Stretch"
                    />
            </Grid>

        </Grid>

        <GridSplitter 
            Grid.Column="1"
            Grid.Row="0"
            Grid.RowSpan="2"
            HorizontalAlignment="Stretch"
            />

    </Grid>

</Window>
